<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Ansible / Bash - Nextcloud Deployment - LXD" /><meta property="og:locale" content="en" /><meta name="description" content="Easy Nextcloud Deployment using bash with ansible." /><meta property="og:description" content="Easy Nextcloud Deployment using bash with ansible." /><link rel="canonical" href="https://github.com/jonnypeace/jonnypeace.github.io.git/posts/ans-nc-lxd/" /><meta property="og:url" content="https://github.com/jonnypeace/jonnypeace.github.io.git/posts/ans-nc-lxd/" /><meta property="og:site_name" content="HomeLab Hub" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-10T13:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Ansible / Bash - Nextcloud Deployment - LXD" /><meta name="twitter:site" content="@JonnyLinuxPeace" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-10T23:22:35+00:00","datePublished":"2022-12-10T13:00:00+00:00","description":"Easy Nextcloud Deployment using bash with ansible.","headline":"Ansible / Bash - Nextcloud Deployment - LXD","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/jonnypeace/jonnypeace.github.io.git/posts/ans-nc-lxd/"},"url":"https://github.com/jonnypeace/jonnypeace.github.io.git/posts/ans-nc-lxd/"}</script><title>Ansible / Bash - Nextcloud Deployment - LXD | HomeLab Hub</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="HomeLab Hub"><meta name="application-name" content="HomeLab Hub"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/motherboard.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">HomeLab Hub</a></div><div class="site-subtitle font-italic">Your one-stop for bash, python & Linux magic</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/jonnypeace" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/JonnyLinuxPeace" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['jonnypeace','outlook.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Ansible / Bash - Nextcloud Deployment - LXD</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Ansible / Bash - Nextcloud Deployment - LXD</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1670677200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 10, 2022 </em> </span> <span> Updated <em class="" data-ts="1670714555" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 10, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/JonnyLinuxPeace">jonny peace</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="722 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h1 id="easy-nextcloud-deployment-using-bash-with-ansible">Easy Nextcloud Deployment using bash with ansible.</h1><p>There are probably ways to make this work with ansible only, but I thought I would use a mix of skills, and it seems to work with just a few configuration adjustments.</p><p>If not done so already, perhaps explore the idea of an LXD host, as i’ve written this for remote LXD hosts. You could just as easily modify this for a local LXD host.</p><p>Since this is taking place over LXD, there’s no need to use SSH. You can use <em>lxc remote switch ‘host’</em> and this will work. This means you don’t need ansible vault.</p><p>I have used docker for such instances, but I quite like what Ubuntu are doing right now with snaps, LXD, microceph and microcloud. If you are now aware of these applications, I encourage you to have a look.</p><h2 id="github"><span class="mr-2">Github</span><a href="#github" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Clone my repo for this…</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>git clone https://github.com/jonnypeace/ansible-lxd-nextcloud.git
</pre></table></code></div></div><h2 id="hostsyaml"><span class="mr-2">hosts.yaml</span><a href="#hostsyaml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The hosts.yaml file needs updated where the comments are, but as you can see you could modify this for local use.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nn">---</span>
<span class="na">all</span><span class="pi">:</span>
  <span class="na">vars</span><span class="pi">:</span>
    <span class="na">ansible_connection</span><span class="pi">:</span> <span class="s">lxd</span>
    <span class="na">ansible_user</span><span class="pi">:</span> <span class="s">root</span>
    <span class="na">ansible_become</span><span class="pi">:</span> <span class="s">no</span>
  <span class="na">children</span><span class="pi">:</span>
    <span class="na">local</span><span class="pi">:</span>
      <span class="na">vars</span><span class="pi">:</span>
        <span class="na">ansible_lxd_remote</span><span class="pi">:</span> <span class="s">local</span>
        <span class="na">ansible_lxd_project</span><span class="pi">:</span> <span class="s">homelab</span>
      <span class="na">hosts</span><span class="pi">:</span>
    <span class="na">lxd-host</span><span class="pi">:</span>  <span class="c1"># Adjust to same name as anible_lxd_remote</span>
      <span class="na">vars</span><span class="pi">:</span>
        <span class="na">ansible_lxd_remote</span><span class="pi">:</span> <span class="s">lxd-host</span> <span class="c1"># Enter your lxd remote host, check with 'lxc remote list' </span>
      <span class="na">hosts</span><span class="pi">:</span>
        <span class="na">new-container</span><span class="pi">:</span> <span class="c1"># This will be the name of the LXD container, so will need adjusted.</span>

</pre></table></code></div></div><h2 id="backupsh"><span class="mr-2">backup.sh</span><a href="#backupsh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is a simple backup and restore script for mariadb and nextcloud. The ansible playbook will use this to restore an old/existing nextcloud, but you will be prompted as to whether this is required. You could always use it to backup and restore day-to-day.</p><p>However, this section at the top of the script needs modified to suit your needs.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">nc_backup</span><span class="o">=</span><span class="s1">'/mnt/nextcloud/backup/nextcloud.tar.bz2'</span>
<span class="nv">nextcloud_dir</span><span class="o">=</span><span class="s1">'/var/www/domain.com/'</span>
<span class="nv">db_pass</span><span class="o">=</span><span class="si">$(</span>&lt; .db-password.txt<span class="si">)</span>
<span class="nv">db_backup</span><span class="o">=</span><span class="s1">'/mnt/nextcloud/backup'</span> <span class="c"># this is a directory</span>
</pre></table></code></div></div><h2 id="config"><span class="mr-2">Config</span><a href="#config" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This should hopefully be self explanatory, comments are already provided in the script to help guide.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="c"># Container Name</span>
container-name<span class="o">=</span>nc-new

<span class="c"># Shared directory/external storage for nextcloud on LXD host</span>
host-share<span class="o">=</span>/mnt/shares/nextcloud

<span class="c"># Where to mount the directory/external storage in the container</span>
cont-mount<span class="o">=</span>/mnt/nextcloud

<span class="c"># For LXD... a name for the device being added to LXD</span>
share-name<span class="o">=</span>nextcloud

<span class="c"># Nextcloud backup, used for restoring an existing nextcloud installation</span>
nextcloud-source<span class="o">=</span>/mnt/shares/nextcloud/backup/nextcloud.tar.bz2

<span class="c"># Database backup, used for restoring the database from an existing nextcloud installation - </span>
<span class="c"># Will only work with the same nextcloud instance described above.</span>
tar-db<span class="o">=</span>/mnt/shares/nextcloud/backup/nextcloud-sqlbkp_20221126.bak

<span class="c"># This will be used in your /var/www directory</span>
www-dir<span class="o">=</span>domain.com

<span class="c"># This will be used in your virtual hosts file.</span>
<span class="nv">domain</span><span class="o">=</span>domain.com

<span class="c"># This is for your apache2 server.</span>
virtual-hosts-file<span class="o">=</span>domain.com.conf
</pre></table></code></div></div><h2 id="nodes_updateyaml"><span class="mr-2">nodes_update.yaml</span><a href="#nodes_updateyaml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This is used to update nodes. Since this is a baremetal nextcloud/mariadb, a simple apt package manager will update most of the container. Nextcloud will need manual updates either via the nextcloud admin page, or something a little more manual.</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nn">---</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Update and Upgrade LXD cluster nodes</span>
  <span class="na">hosts</span><span class="pi">:</span> <span class="s">nc-new</span>
  <span class="na">tasks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Update and upgrade apt packages</span>
    <span class="na">apt</span><span class="pi">:</span>
      <span class="na">upgrade</span><span class="pi">:</span> <span class="s">yes</span>
      <span class="na">update_cache</span><span class="pi">:</span> <span class="s">yes</span>
      <span class="na">cache_valid_time</span><span class="pi">:</span> <span class="m">86400</span>
</pre></table></code></div></div><h2 id="db-passwordtxt"><span class="mr-2">.db-password.txt</span><a href="#db-passwordtxt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I would create this file and use this for your mariadb nextcloud password. Once the password has been added, run…</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">chmod </span>400 .db-password.txt
</pre></table></code></div></div><h2 id="templateyaml"><span class="mr-2">template.yaml</span><a href="#templateyaml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>You shouldn’t need to make any modifications, the script will make the modifications covered in the config files, but feel free to make your own improvements or tweaks that you require. This template will be used to create your nextcloud container playbook file.</p><h2 id="setupsh"><span class="mr-2">setup.sh</span><a href="#setupsh" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Ok, once all config files are ready, this script will guide you through the setup.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./setup.sh
</pre></table></code></div></div><h2 id="wireguard-script"><span class="mr-2">Wireguard Script</span><a href="#wireguard-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>I have left this script in, as originally I would reverse proxy with a VPS directly from nextcloud, but now I put nextcloud behind a second proxy and this proxy takes care of the wireguard traffic (much easier). I will eventually write something with how I do this.</p><h2 id="extras"><span class="mr-2">Extras</span><a href="#extras" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>If you want to upload files larger than 10MB (where I was having problems), chunk size issues may arise with Nextcloud. Try this inside your lxd container…</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo</span> <span class="nt">-u</span> www-data php <span class="nt">--define</span> apc.enable_cli<span class="o">=</span>1 occ config:app:set files max_chunk_size <span class="nt">--value</span> 0
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/bash/'>bash</a>, <a href='/categories/ansible/'>ansible</a>, <a href='/categories/scripting/'>scripting</a>, <a href='/categories/ubuntu/'>ubuntu</a>, <a href='/categories/lxd/'>lxd</a>, <a href='/categories/nextcloud/'>nextcloud</a>, <a href='/categories/mariadb/'>mariadb</a>, <a href='/categories/backup/'>backup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/bash/" class="post-tag no-text-decoration" >bash</a> <a href="/tags/ansible/" class="post-tag no-text-decoration" >ansible</a> <a href="/tags/lxd/" class="post-tag no-text-decoration" >lxd</a> <a href="/tags/nextcloud/" class="post-tag no-text-decoration" >nextcloud</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Ansible+%2F+Bash+-+Nextcloud+Deployment+-+LXD+-+HomeLab+Hub&url=https%3A%2F%2Fgithub.com%2Fjonnypeace%2Fjonnypeace.github.io.git%2Fposts%2Fans-nc-lxd%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Ansible+%2F+Bash+-+Nextcloud+Deployment+-+LXD+-+HomeLab+Hub&u=https%3A%2F%2Fgithub.com%2Fjonnypeace%2Fjonnypeace.github.io.git%2Fposts%2Fans-nc-lxd%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fgithub.com%2Fjonnypeace%2Fjonnypeace.github.io.git%2Fposts%2Fans-nc-lxd%2F&text=Ansible+%2F+Bash+-+Nextcloud+Deployment+-+LXD+-+HomeLab+Hub" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/docker-lxd-keepalive/">High Availability with KeepaliveD-Docker-LXD</a><li><a href="/posts/arch-printer/">Setting up an HP Printer on Arch Linux</a><li><a href="/posts/basic-zfs/">ZFS Mirror, Snapshots, Recovery</a><li><a href="/posts/neovim-customization/">Setting up a Custom Neovim config on Arch Linux</a><li><a href="/posts/inc-tar/">Simple Incremental Backup Script</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/lxd/">lxd</a> <a class="post-tag" href="/tags/ubuntu/">ubuntu</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/arch-linux/">Arch Linux</a> <a class="post-tag" href="/tags/backup/">backup</a> <a class="post-tag" href="/tags/firewall/">firewall</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/zfs/">zfs</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/docker-lxd-keepalive/"><div class="card-body"> <em class="small" data-ts="1682683200" data-df="ll" > Apr 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>High Availability with KeepaliveD-Docker-LXD</h3><div class="text-muted small"><p> Docker-LXD-KeepaliveD This should be a mostly straight forward setup. There are plenty other ways to configure, this probably the easiest. Also, this would work better if you are in an LXD cluste...</p></div></div></a></div><div class="card"> <a href="/posts/backup-lxd/"><div class="card-body"> <em class="small" data-ts="1694966400" data-df="ll" > Sep 17, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Backup/Copy LXD container to another host</h3><div class="text-muted small"><p> The why? Although I run LXD in clusters, my clusters are generally low powered that don’t need much compute. So i do run some services that require compute, on my laptop or desktop in LXD, and he...</p></div></div></a></div><div class="card"> <a href="/posts/jellyfin-nvidia-lxd/"><div class="card-body"> <em class="small" data-ts="1697378400" data-df="ll" > Oct 15, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Nvidia GPU LXD Passthrough</h3><div class="text-muted small"><p> On the host… Install Nvidia drivers 1 2 sudo apt install nvidia-driver-535 sudo reboot Check this website, but the deb network install seemed to work best. Nvidia Cuda Install Instructions As...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Ubuntu-Router/" class="btn btn-outline-primary" prompt="Older"><p>Ubuntu Router</p></a> <a href="/posts/ufw-nginx/" class="btn btn-outline-primary" prompt="Newer"><p>Automate UFW with Nginx and TCP wrapper</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/JonnyLinuxPeace">jonny peace</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/lxd/">lxd</a> <a class="post-tag" href="/tags/ubuntu/">ubuntu</a> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/arch-linux/">Arch Linux</a> <a class="post-tag" href="/tags/backup/">backup</a> <a class="post-tag" href="/tags/firewall/">firewall</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/servers/">servers</a> <a class="post-tag" href="/tags/zfs/">zfs</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"></p><button type="button" class="btn btn-primary" aria-label="Update"> </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
